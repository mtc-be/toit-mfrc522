Reader: 26  // req type A
Tag:    04 00  // answer req
Reader: 93 20   // select
Tag:    c2 a8 2d f4 b3  // uid, bcc
Reader  93 70 c2 a8 2d f4 b3 ba a3  // select uid
Tag     08 b6 dd  // MIFARE 1k
Reader  60 30 76 4a  // auth(block 30)
Tag     42 97 c0 a4  // n_t
Reader  7d db 9b 83 67 eb 5d 83  // n_r X ks1, a_r X ks2
Tag     8b d4 10 08   // a_t X ks3


Another trace with key afffbfffcfff:
...
Reader  93 70 3e b4 e2 49 21 69 62  // select uid
tag     08 b6 dd  // MIFARE 1k
reader  60 02 e7 58  // auth(block 2)
tag     24 5c db ee
reader  58 47 67 bf 68 6f 4f b9
tag     60 21 b9 3d

Trace with key 0xFFFFFFFFFFFF: (from https://ora.ox.ac.uk/objects/uuid:8e52bcfe-5ab5-40b8-b1f4-6b11fd0e67f2/download_file?file_format=application%2Fpdf&safe_filename=12-15.pdf&type_of_work=Working+paper)
UID: 0xCD 0x76 0x92 0x74
Reader -> Tag: 0x60 0x3C 0x1A 0x80  // Auth Key A address 0x3C
Tag -> Reader: 0x0E 0x61 0x64 0xD6  // n_T
Reader -> Tag: 0x15 0x45 0x90 0xA8   --  0x78 0x5A 0x41 0x80  // n_R. Right is encrypted.
Reader -> Tag: 0x4F 0x4E 0x67 0x4E   --  0x50 0x04 0x8F 0x22  // a_R.
Tag -> Reader: 0x41 0x3E 0xEB 0xCF   --  0xCE 0xCA 0x0D 0x83  // a_T.
Reader -> Tag: 0x30      --  0x69       // Read. Right is encrypted.
Reader -> Tag: 0x3F      --  0xAC       // Address
Reader -> Tag: 0x76 0x61 --  0x4F 0x02  // CRC



Good explanation of Crypto-1.
Wirelessly Pickpocketing a Mifare Classic Card:
https://repository.ubn.ru.nl/bitstream/handle/2066/75545/1/75545.pdf
Dismantling Mifare:
https://www.cs.bham.ac.uk/~garciaf/publications/Dismantling.Mifare.pdf

darkside attack: uses parity.

nested attack

hardnested


mfrc datasheet: https://www.nxp.com/docs/en/data-sheet/MFRC522.pdf
iso 14443-3.pdf from 2008-11-24: http://wg8.de/wg8n1496_17n3613_Ballot_FCD14443-3.pdf
iso 14443-3.pdf from 2001: http://www.emutag.com/iso/14443-3.pdf
iso 14443-4.pdf from 2001: http://www.emutag.com/iso/14443-4.pdf
list of other documents: https://wg8.de/1500dlst.html

Mifare description. Commands, layout, access- rights.
Only for 1K cards, but still very nice.
https://www.nxp.com/docs/en/data-sheet/MF1S50YYX_V1.pdf

Distinguishing between Mifare cards: https://www.newark.com/pdfs/techarticles/nxp/AN10833.pdf

Mifare Ultralight: https://www.nxp.com/docs/en/application-note/AN11340.pdf
Ultralight protocol description:
Also contains description of how to build your own tag emulator.
https://ora.ox.ac.uk/catalog/uuid:8e52bcfe-5ab5-40b8-b1f4-6b11fd0e67f2/download_file?file_format=application%2Fpdf&safe_filename=12-15.pdf

Presentation.
Nice detailed discription and how a minimal reader was built:
https://media.defcon.org/DEF%20CON%20China%201/DEF%20CON%20China%201%20presentations/DEF%20CON%20China%201.0%20-%20Presentations/DEF%20CON%20China%201.0%20-%20Christopher-Wade-Tag-side-attacks-against-NFC.pdf

Also explains how to attack crypto-1 from the tag:
   Authentication is allowed to progress until the reader sends a response to the tag’s
   initial nonce
   This response contains a random value followed by an encrypted value generated by
   the tag’s nonce, the generated value can be calculated and XORed with this,
   providing 32-bits of keystream
   The two 24-bit keys generated from the 48-bit initial key are used to calculate each
   alternating bit of the keystream, reducing these values from ~16 million possible
   24-bit keys to ~200,000
   Matching key pairs can be checked in order to find combinations which generate
   the 32-bit keystream
   These keys can be rolled back through the random value and the initial nonce in
   order to recover the initial key

Extremely minimal rfid (iso 14443-3): https://www.nonan.net/nkruse/simplenfc

Master? thesis on how to create an nfc tag: https://www.nonan.net/nkruse/files/copy/passive_nfc_environmental_sensor.pdf


Discussion of authentication protocol:
https://www.researchgate.net/publication/330603078_A_Comprehensive_Review_of_RFID_and_Bluetooth_Security_Practical_Analysis


Proxmark source code:
mfkey: https://github.com/Proxmark/proxmark3/blob/master/tools/mfkey/mfkey32.c

hardnested attack with an MFRC522.
https://github.com/HakonHystad/MFRC522_nested_attack
